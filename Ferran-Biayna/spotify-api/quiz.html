<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Spotify - Quiz</title>
        <link rel="icon" href="https://accounts.scdn.co/images/favicon.ace4d8543bbb017893402a1e9d1ac1fa.ico">
		<link rel="stylesheet" href="styles.css"/>
	</head>
	<body>
        <h1>Quiz - Hans Zimmer</h1>
        <div class="quiz-box">
            <p id="time"></p>
            <div id="quiz"></div>
        </div>
        <a id="back" href="" style="display:none"><button>Inicio</button></a>
		<script src="store.js"></script>
		<script>
            let playlist;
            let turn=0;
            let score=0;

            (async function(){
                await store.getToken()
                playlist = await store.loadPlaylist()
                answerQuiz(turn,score)
            })();

            function answerQuiz() {
                document.getElementById("quiz").innerHTML = store.loadQuestion(playlist,turn)
                document.getElementById("submit").addEventListener('click', () => {
                    let data = new FormData(form);
                    let answer = "";
                    for (const entry of data) {
                        answer = entry[1];
                    };
                    if (answer===questions[turn].correct) {
                        score++
                        document.getElementById('answer').innerHTML = `¡Respuesta correcta!<br>Sumas un total de ${score} punto/s - ${score}/${turn+1}`
                    } else {
                        document.getElementById('answer').innerHTML = `¡Respuesta incorrecta! La respuesta correcta es '${questions[turn].correct}'<br>Sumas un total de ${score} punto/s - ${score}/${turn+1}`
                    }
                    document.getElementById('answer').style.display = "inline-block"
                    nextTurn()
                })
            }

            function nextTurn() {
                document.getElementById('submit').style.display = "none"
                document.getElementById('next').style.display = "inline-block";
                if (turn+1===10) {
                    document.getElementById('next').innerHTML = "Finalizar";
                    document.getElementById('next').addEventListener('click', () => {
                        endQuiz()
                    })
                } else {
                    document.getElementById('next').addEventListener('click', () => {
                        turn++
                        answerQuiz()
                    })
                }
            }

            function endQuiz() {
                document.getElementById("quiz-box").style.display="none";
                document.getElementById("back").style.display="inline-block"
                document.getElementById('back').addEventListener('click', () => {
                        document.getElementById('back').src="./home.html"
                    })
            }

		</script>
	</body>
</html>
